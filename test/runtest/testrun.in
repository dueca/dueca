#!/usr/bin/bash

@XVFB@ @DISPLAY@ -screen 0 @DISPLAYSIZE@x24 &
XVFBPID=$!

sleep 1
DISPLAY=@DISPLAY@ @WINDOWMANAGER@ &
sleep 1
DISPLAY=@DISPLAY@ timeout --kill-after=10 @TIMELIMIT@ \
       @Python_EXECUTABLE@ @CMAKE_CURRENT_SOURCE_DIR@/testrunner.py \
       --base @TESTRUN_BASE@ \
       --control @CMAKE_CURRENT_SOURCE_DIR@/@CONTROLFILE@.xml
RESULT=$?
sleep 1

kill ${XVFBPID}
exit ${RESULT}


